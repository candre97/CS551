<?xml version="1.0"?>
<test lab="lab1_ext">

<description>
    This extends the lab1 topology with an extra router, to test if your router
    interoperates with other routers. In this topology, server2 is configured as
    a router and forwards traffic for server3 and server4. See the "test_cases"
    section below for the list of tests.
</description>

<init>
  <run_command>pkill -9 -f SimpleHTTPServer</run_command>
  <run_command>pkill -9 -f webserver.py</run_command>
  <run_command>./init_tests.sh</run_command>
</init>

<startup>
  <run_command sleep="5">screen -S sr -d -m ./router/sr</run_command>
  <run_command at="server1" sleep="3">ifconfig server1-eth0 down</run_command>
</startup>


<test_cases>
  <pingunreach>client server1</pingunreach>
  <iperf expect="2.8">client server3</iperf>
  <traceroute expect="10.0.1.1 172.64.3.10 172.64.3.34">client server4</traceroute>
  <wget at="client" from="server3">bovard.jpeg</wget>
  <wget at="client" from="server4">bovard.jpeg</wget>
</test_cases>

</test>
